(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function e(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=e(r);fetch(r.href,i)}})();class c{constructor(t){this.seconds=0,this.minutes=0,this.interval=null,this.clock=t}start(){this.interval||(this.updateClock(),this.interval=setInterval(()=>{this.seconds++,this.seconds==60&&(this.seconds=0,this.minutes++),this.updateClock()},1e3))}startFrom(t,e){this.seconds=e,this.minutes=t,this.start()}stop(){return clearInterval(this.interval),this.interval=null,`${this.minutes} : ${this.seconds}`}catch(){return`${this.minutes} : ${this.seconds}`}restart(){this.stop(),this.seconds=0,this.minutes=0,this.start()}updateClock(){this.clock.textContent=`${this.minutes.toString().padStart(2,"0")} : ${this.seconds.toString().padStart(2,"0")}`}}function l(){let a="#",t="0123456789ABCDEF";for(let e=0;e<6;e++){let s=Math.floor(Math.random()*16);a+=t[s]}return a}function o(a){for(let t=a.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[a[t],a[e]]=[a[e],a[t]]}return a}class d{constructor(){this.grid=document.querySelector(".grid"),this.numBoxes=0}generateBoard(t){switch(this.grid.removeAttribute("data-info-size"),this.grid.classList.remove("easy","medium","hard"),this.grid.innerHTML="",this.grid.classList.add(t),t){case"easy":this.numBoxes=12;break;case"medium":this.numBoxes=30;break;case"hard":this.numBoxes=56;break}this.grid.setAttribute("data-info-size",this.numBoxes);for(let e=0;e<this.numBoxes;e++){let s=document.createElement("div");if(e%2===1){let r=l();s.style.backgroundColor=r,s.setAttribute("data-original-color",r);let i=this.grid.children[e-1];i.style.backgroundColor=r,i.setAttribute("data-original-color",r)}s.classList.add("box"),this.grid.appendChild(s)}}createBoardFrom(t){let e=t;this.numBoxes=e.length;for(let s=0;s<this.numBoxes;s++){let r=document.createElement("div"),i=e[s].color;e[s].classes.forEach(n=>{r.classList.add(n)}),r.setAttribute("data-original-color",i),r.style.backgroundColor=i,this.grid.appendChild(r)}}}class h{constructor(){this.user,this.dificulty,this.active,this.numCorrects,this.currentScore=0,this.timeoutID=null,this.currentTime,this.gameBox=new d,this.usersData=JSON.parse(localStorage.getItem("users")),this.usersGames=JSON.parse(localStorage.getItem("usersGames")),this.userMenu=document.querySelector(".user__menu"),this.logInBtn=document.querySelector(".login-btn"),this.logInBtn.addEventListener("click",()=>this.logIn()),this.logOutBtn=document.querySelector(".logout--btn"),this.logOutBtn.addEventListener("click",()=>this.logOut()),this.newUserBtn=document.querySelector(".signup-btn"),this.newUserBtn.addEventListener("click",()=>this.signUp()),this.newgameContainer=document.querySelector(".newgame__menu"),this.newgameContainer.addEventListener("click",()=>this.newgameContainer.classList.add("hidden")),this.newGameBtn=document.querySelector(".newgame--btn"),this.newGameBtn.addEventListener("click",()=>this.dificultyContainer.classList.remove("hidden")),this.loadGameBtn=document.querySelector(".loadgame--btn"),this.loadGameBtn.addEventListener("click",()=>this.loadGame()),this.dificultyContainer=document.querySelector(".dificulty__container"),this.dificultyForm=document.querySelector(".dificulty__form"),this.dificultyForm.addEventListener("submit",t=>t.preventDefault()),this.radioBtns=document.querySelectorAll('input[name="difficulty"]'),this.radioBtns.forEach(t=>{t.addEventListener("change",e=>{this.dificulty=e.target.value,this.gameBox.generateBoard(this.dificulty)})}),this.startGameBtn=document.querySelector(".form__btn"),this.startGameBtn.addEventListener("click",()=>this.startGame()),this.grid=document.querySelector(".grid"),this.gameInfo=document.querySelector(".game__info"),this.clock=document.querySelector(".clock"),this.timer=new c(this.clock),this.scoreSpan=document.querySelector(".score"),this.gameBtns=document.querySelector(".game__btns"),this.restartBtn=document.querySelector(".btn--restart"),this.restartBtn.addEventListener("click",()=>this.restartGame()),this.changeDifficultyBtn=document.querySelector(".btn--change"),this.changeDifficultyBtn.addEventListener("click",()=>this.dificultyContainer.classList.remove("hidden")),this.saveGameBtn=document.querySelector(".btn--save"),this.saveGameBtn.addEventListener("click",()=>this.saveGame())}signUp(){this.user=prompt("Introduce tu nombre de usuario"),this.usersData=this.usersData||{},this.usersData[this.user]={highestScore:{easy:0,medium:0,hard:0},fastestTime:{easy:0,medium:0,hard:0}},localStorage.setItem("users",JSON.stringify(this.usersData))}logIn(){if(this.user){alert("Ya estas logueado");return}let t=prompt("Ingresa tu nombre de usuario");if(this.usersData[t])this.user=t;else{alert("Este nombre de usuario no existe");return}let e=document.createElement("h2");e.innerHTML=`Bienvenido ${this.user}`,this.userMenu.appendChild(e),this.logInBtn.classList.add("hidden"),this.newUserBtn.classList.add("hidden"),this.logOutBtn.classList.remove("hidden")}logOut(){}startGame(){this.timer.restart(),this.dificultyContainer.classList.add("hidden"),this.dificulty||alert("Por favor seleccione una dificultad"),document.querySelector(".game__btns").classList.remove("hidden"),document.querySelector(".game__info").classList.remove("hidden"),this.boxes=o(Array.from(document.querySelectorAll(".box"))),this.timer.start(this.clock),this.grid.innerHTML="",this.boxes.forEach(s=>{s.classList.add("black"),s.classList.remove("correct","active"),s.setAttribute("draggable","false"),s.addEventListener("click",this.flipCard.bind(this)),s.addEventListener("dragstart",this.handleDragStart.bind(this)),s.addEventListener("dragover",this.handleDragOver.bind(this)),s.addEventListener("drop",this.handleDrop.bind(this)),this.grid.appendChild(s)})}restartGame(){this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=null),this.timer.restart();let t=document.querySelectorAll(".correct , .active"),s=Array.from(document.querySelectorAll(".box")).filter(i=>!i.classList.contains("black"));[...t,...s].forEach(i=>{i.classList.add("black"),i.classList.remove("active","correct"),i.classList.add("black"),i.setAttribute("draggable","false"),i.addEventListener("click",this.flipCard)}),this.numCorrects=0,this.active=null,this.boxes=o(this.boxes),this.grid.innerHTML="",this.boxes.forEach(i=>this.grid.appendChild(i)),this.currentScore=0,this.handleScore()}saveGame(){if(!this.user){alert("Debes iniciar sesion para guardar la partida");return}this.currentTime=this.timer.stop(),this.usersGames=this.usersGames||{};let t=Array.from(this.grid.children).map(e=>({classes:[...e.classList],color:e.getAttribute("data-original-color")}));this.usersGames[this.user]={grid:t,score:this.currentScore,time:this.currentTime},localStorage.setItem("usersGames",JSON.stringify(this.usersGames)),alert("Partida guardada")}loadGame(){this.gameInfo.classList.remove("hidden"),this.gameBtns.classList.remove("hidden"),this.user||(this.user=prompt("Ingresa tu nombre de usuario para cargar partida")),this.currentScore=this.usersGames[this.user].score,this.handleScore(this.currentScore),this.currentTime=this.usersGames[this.user].time;let t=this.currentTime.split(":");this.timer.startFrom(t[0],t[1]);let e=this.usersGames[this.user].grid;this.gameBox.createBoardFrom(e),this.boxes=Array.from(document.querySelectorAll(".box")),this.grid.innerHTML="",this.boxes.forEach(s=>{s.addEventListener("click",this.flipCard.bind(this)),s.addEventListener("dragstart",this.handleDragStart.bind(this)),s.addEventListener("dragover",this.handleDragOver.bind(this)),s.addEventListener("drop",this.handleDrop.bind(this)),this.grid.appendChild(s)})}storeUserData(){this.user="Jesus";let t=users[this.user].highestScore[this.dificulty],e=users[this.user].fastestTime[this.dificulty];(!users||!users[this.user])&&alert("No existe ningun usuario con ese nombre"),this.currentScore>t&&(t=this.currentScore),this.currentTime>e&&(e=this.currentTime),localStorage.setItem("users",JSON.stringify(users))}flipCard(t){this.currentBox=t.target,!this.active&&this.currentBox&&!this.currentBox.classList.contains("correct")&&(this.active=this.currentBox,this.active.classList.add("active"),this.active.classList.remove("black"),this.active.setAttribute("draggable","true"))}handleDragStart(t){(t.target.getAttribute("draggable")==="false"||t.target!==this.active)&&t.preventDefault()}handleDragOver(t){t.target.classList.contains("black")&&t.preventDefault()}handleDrop(t){const e=t.target.closest(".box");!e||e===this.active||(e.classList.remove("black"),this.active.dataset.originalColor!==e.dataset.originalColor?this.handleError(e):this.handleCorrect(e))}handleCorrect(t){this.currentScore+=100,this.handleScore(),this.active.classList.remove("active","black"),this.active.classList.add("correct"),this.active.setAttribute("draggable","false"),this.active.removeEventListener("click",this.flipCard),t.classList.remove("black"),t.classList.add("correct"),t.removeEventListener("click",this.flipCard),this.active=null,this.numCorrects++,this.checkWin()}handleError(t){this.currentScore-=10,this.handleScore(),this.active.classList.remove("active"),this.active.setAttribute("draggable","false"),this.timeoutID=setTimeout(()=>{this.active.classList.add("black"),t.classList.add("black"),this.active=null},800)}handleScore(){this.scoreSpan.innerHTML=`Puntuaci√≥n: ${this.currentScore}`}}new h;
